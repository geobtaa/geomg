<h2 id="identification">Identification</h2>

<div class="grouping">
  <h3 id="descriptive">Descriptive</h3>
  <%= f.input :title, hint: "Theme: city, state, temporal coverage" %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:alternative_title], build: :at_least_one %>

  <%= f.repeatable_attr_input(GEOMG_SOLR_FIELDS[:description], build: :at_least_one) do |input_name, value| %>
     <div class="form-group">
       <%= f.input_field GEOMG_SOLR_FIELDS[:description], name: input_name, value: value, as: :text, class: "form-control", rows: 4 %>
     </div>
   <% end %>

  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:language], build: :at_least_one,
  html_attributes: { "data-scihist-qa-autocomplete" => qa_search_vocab_path("local", "languages")} %>
</div>

<div class="grouping">
  <h3 id="credits">Credits</h3>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:creator], build: :at_least_one %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:creator_id], build: :at_least_one %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:publisher], build: :at_least_one %>

  <%= f.input GEOMG_SOLR_FIELDS[:provider], label: "Provider" %>
</div>

<div class="grouping">
  <h3 id="categories">Categories</h3>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:resource_class], build: :at_least_one do |input_name, value| %>
    <%= f.input_field GEOMG_SOLR_FIELDS[:resource_class], selected: value, include_blank: true, id: nil,
        collection: Document::ControlledLists::GENRE,
        name: input_name,
        class: "form-control input-primitive" %>
  <% end %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:resource_type], build: :at_least_one,
  html_attributes: { "data-scihist-qa-autocomplete" => qa_search_vocab_path("local", "resource_type")} %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:subject], build: :at_least_one %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:theme], build: :at_least_one do |input_name, value| %>
    <%= f.input_field GEOMG_SOLR_FIELDS[:theme], selected: value, include_blank: true, id: nil,
        collection: Document::ControlledLists::THEME,
        name: input_name,
        class: "form-control input-primitive" %>
  <% end %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:keyword], build: :at_least_one %>
</div>

<div class="grouping">
  <h3 id="temporal">Temporal</h3>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:temporal_coverage], build: :at_least_one %>
  <%= f.input GEOMG_SOLR_FIELDS[:date_issued], label: "Date Issued", hint: "YYYY", input_html: { data: {js: 'datepicker-years'} } %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:date_range], build: :at_least_one,
  html_attributes: { "data-inputmask-regex" => "'mask': '/\d{4}|\*-\d{4}|\*/'", 'placeholder': 'YYYY-YYYY'} %>
</div>

<div class="grouping">
  <h3 id="spatial">Spatial</h3>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:spatial_coverage], build: :at_least_one %>
  <%= f.input GEOMG_SOLR_FIELDS[:bounding_box], label: "Bounding Box", hint: "W,S,E,N - A centroid will be derived from this value." %>
  <%= f.input GEOMG_SOLR_FIELDS[:geometry], label: "Geometry", hint: "WKT - An ENVELOPE, POLYGON, or MULTIPOLYGON value. Use ENVELOPE(-180,180,90,-90) for a whole earth geometry." %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:geonames], build: :at_least_one %>
</div>

<div class="grouping">
  <h3 id="relations">Relations</h3>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:relation], build: :at_least_one %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:member_of], build: :at_least_one %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:is_part_of], build: :at_least_one %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:source], build: :at_least_one %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:is_version_of], build: :at_least_one %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:replaces], build: :at_least_one %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:is_replaced_by], build: :at_least_one %>
</div>

<h2 id="distribution">Distribution</h2>

<div class="grouping">
  <h3 id="object">Object</h3>
  <%= f.input GEOMG_SOLR_FIELDS[:format], :input_html => { :data => { "scihist-qa-autocomplete" => qa_search_vocab_path("local", "formats")}}, label: "Format" %>
  <%= f.input GEOMG_SOLR_FIELDS[:file_size] %>
  <%= f.input GEOMG_SOLR_FIELDS[:wxs_identifier] %>
  <%= f.input GEOMG_SOLR_FIELDS[:georeferenced], as: :boolean, inline_label: 'Georeferenced' %>
</div>

<div class="grouping">
  <h3 id="links">Links</h3>
  <%= f.repeatable_attr_input(GEOMG_SOLR_FIELDS[:reference], build: :at_least_one) do |sub_form| %>
    <%= category_and_value(sub_form, category_list: Document::Reference::REFERENCE_VALUES.keys) %>
  <% end %>
  <%= f.input GEOMG_SOLR_FIELDS[:b1g_image_url], label: "B1G Image URL" %>

  <%- if @document.persisted? %>
    <h3 id="multiple-download-links"><%= link_to "Multiple Download Links", document_document_downloads_url(@document) %></h3>
    <div class="table-responsive">
      <table class="table table-striped table-bordered">
        <thead>
          <tr>
            <th colspan="2">Actions</th>
            <th>Layer Slug</th>
            <th>Download Label</th>
            <th>Download URL</th>
          </tr>
        </thead>

        <tbody>
          <% @document.document_downloads.each do |document_download| %>
            <tr>
              <td><%= link_to 'Edit', edit_document_document_download_path(document_download.document, document_download) %></td>
              <td><%= link_to 'Destroy', document_document_download_path(document_download.document, document_download), method: :delete, data: { confirm: 'Are you sure?' } %></td>
              <td><%= link_to document_download.friendlier_id, document_path(document_download.document) %></td>
              <td><%= document_download.label %></td>
              <td><%= link_to document_download.value %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% end %>

</div>

<h2 id="administrative">Administrative</h2>
<div class="grouping">
  <h3 id="codes">Codes</h3>

  <% if @document.persisted? %>
    <%= f.input GEOMG_SOLR_FIELDS[:id], required: true, label: "ID", input_html: { disabled: true } %>
  <% else %>
    <%= f.input GEOMG_SOLR_FIELDS[:id], required: true, label: "ID" %>
  <% end %>

  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:identifier], build: :at_least_one %>
  <%= f.input GEOMG_SOLR_FIELDS[:code], label: "Code" %>
</div>

<div class="grouping">
  <h3 id="rights">Rights</h3>
  <%= f.input GEOMG_SOLR_FIELDS[:access_rights], collection: Document::ControlledLists::ACCESS_RIGHTS, required: true %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:rights_holder], build: :at_least_one %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:license], build: :at_least_one %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:rights], build: :at_least_one %>
</div>

<div class="grouping">
  <h3 id="life-cycle">Life Cycle</h3>

  <% if @document.persisted? %>
    <%= f.input :created_at, as: 'string', label: "Created At", input_html: { disabled: true } %>
    <%= f.input :updated_at, as: 'string', label: "Last Updated", input_html: { disabled: true } %>
  <% end %>

  <%= f.input GEOMG_SOLR_FIELDS[:accrual_method], label: "Accrual Method" %>
  <%= f.input GEOMG_SOLR_FIELDS[:accrual_periodicity], collection: Document::ControlledLists::B1G_ACCRUAL_PERIODICITY, label: "Accrual Periodicity" %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:date_accessioned], build: :at_least_one %>
  <%= f.input GEOMG_SOLR_FIELDS[:date_retired], label: 'Date Retired', hint: 'YYYY-MM-DD', input_html: { data: {js: :datepicker} } %>
  <%= f.input GEOMG_SOLR_FIELDS[:status], label: 'Status' %>

  <% if @document.persisted? %>
    <%= f.input :publication_state, label: 'Publication State', required: true, collection: Document::ControlledLists::PUBLICATION_STATE %>
  <% else %>
    <%= f.hidden_field :publication_state %>
  <% end %>
</div>

<div class="grouping">
  <h3 id="accessibility">Accessibility</h3>
  <%= f.input GEOMG_SOLR_FIELDS[:suppressed_record], as: :boolean, inline_label: 'Suppressed' %>
  <%= f.input GEOMG_SOLR_FIELDS[:child_record], as: :boolean, inline_label: 'Child' %>
  <%= f.repeatable_attr_input GEOMG_SOLR_FIELDS[:mediator], build: :at_least_one %>
  <%= f.input GEOMG_SOLR_FIELDS[:access] %>
</div>
<hr/>
